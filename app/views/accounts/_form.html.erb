<p>
  <b><%= form.label :username %></b>
  <br />
  <% if form.object.new_record? %>(<%=t :registration_username_info %>)<br /><% end %>
  <%= form.text_field :username, :disabled => !form.object.new_record? %>
</p>

<% if form.object.new_record? %>
  <p>
    <% if Account::SELFVERIFICATION_METHODS.length != 1 %>
      <%= form.hidden_field :verification_method %>
    <% else %>
      <b><%= form.label :verification_method %></b>
      <br />
      <%= form.select :verification_method, 
        Account::SELFVERIFICATION_METHODS_SELECT, 
        { :multiple => false },
        { :onchange => "enable_verification_blocks(this);" }
      %>
    <% end %>
  </p>

  <div id="mobile_phone_verification-block" style="display:<%= form.object.verification_method == Account::VERIFY_BY_MOBILE ? 'inline' : 'none' %>">
    <p>
      <b><%= form.label :mobile_phone %></b>
      <br />
    </p>
    <table>
      <tr>
        <td><b><%= form.label :mobile_prefix %></b></td>
        <td>
          <b><%= form.label :mobile_suffix %></b>
        </td>
      </tr>
      <tr>
        <td>
          <%= form.select :mobile_prefix, 
            mobile_prefixes.map { |m| [ m.prefix, m.prefix.to_s ]}, 
            { :prompt => t(:select_prefix), :multiple => false }
          %>
        </td>
        <td>
          <%= form.text_field :mobile_suffix %>
        </td>
      </tr>
    </table>

    <p>
      <b><%= form.label :mobile_phone_confirmation %></b>
      <br />
		</p>
    <table>
      <tr>
        <td><b><%= form.label :mobile_prefix_confirmation %></b></td>
        <td>
          <b><%= form.label :mobile_suffix_confirmation %></b>
        </td>
      </tr>
      <tr>
        <td>
          <%= form.select :mobile_prefix_confirmation ,
            mobile_prefixes.map { |m| [ m.prefix, m.prefix.to_s ]}, 
            { :prompt => t(:select_prefix), :multiple => false }
          %>
        </td>
        <td>
          <%= form.text_field :mobile_suffix_confirmation %>
        </td>
      </tr>
    </table>
  </div>
  <div id="credit_card_verification-block" style="display:<%= form.object.verification_method == Account::VERIFY_BY_MOBILE ? 'none' : 'inline' %>">
	  <table>
	    <tr>
	      <td>
	        <b><%=t :credit_card_instructions, :count => Configuration.get("credit_card_verification_cost") %></b>
	      </td>
	    </tr>
	  </table>
  </div>
<% else %>
  <% if form.object.verification_method == Account::VERIFY_BY_MOBILE %>
    <p>
      <b><%= form.label :mobile_phone %></b>
      <br />      
    </p>
		<table>
	     <tr>
	       <td><b><%= form.label :mobile_prefix %></b></td>
	       <td>
	         <b><%= form.label :mobile_suffix %></b>
	       </td>
	     </tr>
	     <tr>
	       <td>
	         <%= form.select :mobile_prefix,
	           mobile_prefixes.map { |m| [ m.prefix, m.prefix.to_s ]}, 
	           { :prompt => t(:select_prefix), :multiple => false },
	           :disabled => true
	         %>
	       </td>
	       <td>
	         <%= form.text_field :mobile_suffix, :disabled => true %>
	       </td>
	     </tr>
	   </table>
  <% elsif form.object.verification_method == Account::VERIFY_BY_DOCUMENT %>
    <p>
      <b><%= form.label :document_photo %></b>
      <br />
      <p style="text-align:center">
        <%= embedded_image_tag(form.object.operate { |img| img.resize 100 }) %>
      </p>
    </p>
  <% end %>
<% end %>

<p>
  <b><%= form.label :given_name %></b>
  <br />
  <%= form.text_field :given_name, :size => 20, :disabled => !form.object.new_record?  %>
</p>

<p>
  <b><%= form.label :surname %></b>
  <br />
  <%= form.text_field :surname, :size => 20, :disabled => !form.object.new_record?  %>
</p>

<p>
  <b><%= form.label :birth_date %></b>
  <br />
</p>
<div style="text-align:center" class="date">
	<%= form.date_select :birth_date, :start_year => Time.now.year - 90, :end_year => Time.now.year - 14, :disabled => !form.object.new_record?, :prompt => true %>
</div>

<p>
  <b><%= form.label :address %></b>
  <br />
  <%= form.text_field :address, :size => 50 %>
</p>

<p>
  <b><%= form.label :zip %></b>
  <br />
  <%= form.text_field :zip, :size => 10 %>
</p>

<p>
  <b><%= form.label :city %></b>
  <br />
  <%= form.text_field :city %>
</p>

<p>
  <b><%= form.label :state %></b>
  <br />
  <%= form.select :state, 
    countries.map { |c| [ c.printable_name, c.printable_name ]}, 
    { :multiple => false }
  %>
</p>

<p>
  <b><%= form.label :email %></b>
  <br />
  <% if form.object.new_record? %>(<%=t :registration_email_info %>)<br /><% end %>
  <%= form.text_field :email %>
</p>

<p>
  <b><%= form.label :email_confirmation %></b>
  <br />
  <%= form.text_field :email_confirmation %>
</p>

<p>
  <b><%= form.label :password, form.object.new_record? ? nil : t(:change_password) %></b>
  <br />
  <% if form.object.new_record? %>(<%=t :registration_password_info %>)<br /><% end %>
  <%= form.password_field :password %>
</p>

<p>
  <b><%= form.label :password_confirmation %></b>
  <br />
  <%= form.password_field :password_confirmation %>  
</p>

<% if form.object.new_record? %>
  <%= show_simple_captcha( :label => t(:registration_captcha_info), :object => form.object_name, :distorsion => :medium, :image_style => :simply_red ) %>
  <br />
  <br />
  <p>
    <%= link_to t(:Click_for_eula), document_path('eula.pdf'), :target => '_blank' %>
    <br />
    <%= label_tag 'account_eula_acceptance', t(:eula_description) %><br />
    <%= form.check_box :eula_acceptance %>
    <br />
    <br />
    <%= link_to t(:Click_for_privacy), document_path('privacy.pdf'), :target => '_blank' %>
    <br />
    <%= label_tag 'account_privacy_acceptance', t(:privacy_description) %><br />
    <%= form.check_box :privacy_acceptance %>
  </p>

<% else %>
  <p>
    <b><%= label_tag t(:disable_account) %></b>
    <br />
    <%= check_box_tag 'account_disable_account', '1', false, { :onclick => "if (this.checked) { return #{confirm_javascript_function(t(:Account_disable_confirmation))};}", :name => 'account[disable_account]' } %>
    <br />
  </p>
<% end %>

<table>
  <tbody>
    <tr>
      <td><%= form.submit form.object.new_record? ? t(:Register) : t(:Update) %></td>
      <td><%= link_to t(:Undo), :back %></td>
    </tr>
  </tbody>
</table>

<%= javascript_tag '
  function enable_verification_blocks(el) {
    if (el.value == "mobile_phone") {
      document.getElementById("mobile_phone_verification-block").style.display = "inline";
      document.getElementById("credit_card_verification-block").style.display = "none";
    } else {
      document.getElementById("mobile_phone_verification-block").style.display = "none";
      document.getElementById("credit_card_verification-block").style.display = "inline";    
    }
  }
'
%>
